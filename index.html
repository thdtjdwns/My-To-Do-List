<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MY TO-DO LIST (Ultimate Swag)</title>
    <!-- Google Fonts - Bebas Neue (ì œëª©), Roboto (ë³¸ë¬¸) -->
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            /* Ultimate Swag ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ */
            --bg-color: #121212; /* ë” ì–´ë‘ìš´ ë°°ê²½ */
            --container-bg: #1e1e1e; /* ì»¨í…Œì´ë„ˆ ë°°ê²½ìƒ‰ */
            --item-bg: #2a2a2a; /* í•  ì¼ í•­ëª© ë°°ê²½ìƒ‰ */
            --primary-color: #bb86fc; /* ë©”ì¸ í¬ì¸íŠ¸ìƒ‰ (ë³´ë¼) */
            --secondary-color: #03dac6; /* ì„œë¸Œ í¬ì¸íŠ¸ìƒ‰ (ë¯¼íŠ¸) */
            --delete-color: #cf6679; /* ì‚­ì œ ë²„íŠ¼ìƒ‰ (ë¹¨ê°•) */
            --edit-color: #fcd752; /* ìˆ˜ì • ë²„íŠ¼ìƒ‰ (ë…¸ë‘) */
            --text-color: #e0e0e0; /* ë°ì€ í…ìŠ¤íŠ¸ìƒ‰ */
            --light-text: #a9a9a9; /* ì—°í•œ í…ìŠ¤íŠ¸ìƒ‰ (ì‹œê°„, ë‚ ì§œ ë“±) */
            --completed-text: #7a7a7a; /* ì™„ë£Œ í…ìŠ¤íŠ¸ìƒ‰ */
            --border-color: #3a3a3a; /* ê²½ê³„ì„  ìƒ‰ */
            --input-bg: #2a2a2a; /* ì…ë ¥ í•„ë“œ ë°°ê²½ìƒ‰ */
            --input-border: #4a4a4a; /* ì…ë ¥ í•„ë“œ ë³´ë” */
            --focus-glow: #bb86fc50; /* í¬ì»¤ìŠ¤ ì‹œ ë¹› íš¨ê³¼ */

            --priority-important-color: var(--delete-color); /* ì¤‘ìš”! ë¹¨ê°• */
            --priority-high-color: #ff9800; /* ë†’ìŒ ì£¼í™© */
            --priority-medium-color: #2196f3; /* ë³´í†µ íŒŒë‘ */
            --priority-low-color: #4caf50; /* ë‚®ìŒ ì´ˆë¡ */

            /* ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„ */
            --animation-duration: 0.4s;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--bg-color); /* ê¸°ë³¸ ë°°ê²½ */
             /* ë°°ê²½ ê·¸ë¼ë°ì´ì…˜ ì¶”ê°€ (ì˜µì…˜: íŒ¨í„´ ë„£ìœ¼ë ¤ë©´ ì—¬ê¸° ìˆ˜ì •) */
            background: linear-gradient(135deg, var(--bg-color) 0%, #2a1a3a 100%);
            background-attachment: fixed; /* ë°°ê²½ ê³ ì • */
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh; /* ìµœì†Œ ë†’ì´ ì„¤ì • */
        }

        .container {
            max-width: 700px;
            margin: 20px auto;
            background-color: var(--container-bg);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); /* ê·¸ë¦¼ì ë” ì§„í•˜ê²Œ */
            border: 1px solid var(--border-color); /* í…Œë‘ë¦¬ ì¢€ ì–‡ê²Œ */
            position: relative; /* ì• ë‹ˆë©”ì´ì…˜ ê¸°ì¤€ì  */
            overflow: hidden; /* ëª¨ì„œë¦¬ ë‘¥ê·¼ ë¶€ë¶„ ê·¸ë¦¼ì ì²˜ë¦¬ */
        }

        h1 {
            font-family: 'Bebas Neue', sans-serif;
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 3em; /* ì œëª© ë” í¬ê²Œ! */
            letter-spacing: 4px; /* ê¸€ì ê°„ê²© ë” ë„“ê²Œ! */
            text-shadow: 0 0 5px var(--primary-color); /* ë„¤ì˜¨ íš¨ê³¼ ì‚´ì§ */
        }

        .input-area {
            display: flex;
            margin-bottom: 25px;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .input-area input[type="text"],
        .input-area input[type="date"],
        .input-area input[type="time"],
        .input-area select
         {
            flex-grow: 1;
            padding: 12px;
            border: 1px solid var(--input-border); /* ë³´ë” ë‘ê»˜ */
            border-radius: 4px;
            min-width: 80px;
            font-size: 1em;
            box-sizing: border-box;
            background-color: var(--input-bg);
            color: var(--text-color);
            cursor: pointer;
            transition: border-color 0.3s ease, box-shadow 0.3s ease; /* í¬ì»¤ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
        }
         /* ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ íš¨ê³¼ */
         .input-area input[type="text"]:focus,
         .input-area input[type="date"]:focus,
         .input-area input[type="time"]:focus,
         .input-area select:focus {
             outline: none; /* ê¸°ë³¸ íŒŒë€ìƒ‰ í¬ì»¤ìŠ¤ ì•„ì›ƒë¼ì¸ ì œê±° */
             border-color: var(--primary-color); /* í¬ì»¤ìŠ¤ ì‹œ ë³´ë” ìƒ‰ ë³€ê²½ */
             box-shadow: 0 0 8px var(--focus-glow); /* ë¹› íš¨ê³¼ */
         }


        .input-area input[type="time"] {
             flex-grow: 0;
             width: 110px;
             flex-shrink: 0;
        }
         .input-area input[type="date"] {
             flex-grow: 0;
             width: 140px;
             flex-shrink: 0;
         }
        .input-area select {
            flex-grow: 0;
            width: 120px;
            flex-shrink: 0;
             padding: 12px 8px;
        }
        .input-area input[type="text"]#todoInput {
             flex-grow: 2;
             min-width: 150px;
        }
        .input-area input[type="text"]#categoryInput {
             flex-grow: 1;
             min-width: 100px;
        }


        .input-area button {
            padding: 12px 20px;
            background-color: var(--secondary-color); /* ë¯¼íŠ¸ìƒ‰ ë²„íŠ¼ */
            color: #121212; /* ì–´ë‘ìš´ ê¸€ììƒ‰ */
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease; /* í˜¸ë²„/í´ë¦­ ì• ë‹ˆë©”ì´ì…˜ */
            flex-shrink: 0;
            font-size: 1em;
            font-weight: 700; /* ê¸€ì”¨ ë‘ê»ê²Œ */
            text-transform: uppercase; /* ëŒ€ë¬¸ìë¡œ */
        }
        .input-area button:hover {
            background-color: #00a896; /* í˜¸ë²„ ì‹œ ì‚´ì§ ì§„í•˜ê²Œ */
        }
         .input-area button:active { /* í´ë¦­ ì‹œ */
             transform: scale(0.95); /* ì‚´ì§ ì‘ì•„ì§€ëŠ” íš¨ê³¼ */
         }


        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 15px;
        }
        .controls .filter-sort-controls {
             display: flex;
             gap: 10px;
             flex-wrap: wrap;
        }
         .controls select {
             padding: 8px 10px;
             border: 1px solid var(--input-border);
             border-radius: 4px;
             background-color: var(--input-bg);
             color: var(--text-color);
             font-size: 0.9em;
             cursor: pointer;
             flex-shrink: 0;
             transition: border-color 0.3s ease, box-shadow 0.3s ease; /* í¬ì»¤ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
         }
          .controls select:focus {
              outline: none;
              border-color: var(--primary-color);
              box-shadow: 0 0 8px var(--focus-glow);
          }

         .controls option {
              background-color: var(--input-bg);
              color: var(--text-color);
         }

        .controls button {
             padding: 8px 15px;
             background-color: var(--delete-color);
             color: white;
             border: none;
             border-radius: 4px;
             cursor: pointer;
             transition: background-color 0.3s ease, transform 0.1s ease; /* í˜¸ë²„/í´ë¦­ ì• ë‹ˆë©”ì´ì…˜ */
             font-size: 0.9em;
        }
        .controls button:hover {
            background-color: #c03c51; /* í˜¸ë²„ ì‹œ ì‚´ì§ ì§„í•˜ê²Œ */
        }
        .controls button:active { /* í´ë¦­ ì‹œ */
             transform: scale(0.95); /* ì‚´ì§ ì‘ì•„ì§€ëŠ” íš¨ê³¼ */
         }

        .counts span {
            margin-right: 15px;
            font-size: 0.95em;
            color: var(--light-text);
        }

        .todo-list {
            list-style: none;
            padding: 0;
        }
        .todo-list li {
            background-color: var(--item-bg);
            border: 1px solid var(--border-color); /* ë³´ë” ì¢€ ì–‡ê²Œ */
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            word-break: break-word;
            justify-content: space-between;
            gap: 15px;
            flex-wrap: wrap;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease, opacity var(--animation-duration) ease, margin-bottom var(--animation-duration) ease; /* ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
            position: relative;
             opacity: 1; /* ê¸°ë³¸ íˆ¬ëª…ë„ */
             transform: translateY(0); /* ê¸°ë³¸ ìœ„ì¹˜ */
        }
         /* ì¤‘ìš”ë„ë³„ ì™¼ìª½ ë³´ë” ìƒ‰ìƒ */
         .todo-list li.priority-important { border-left: 5px solid var(--priority-important-color); padding-left: 10px;}
         .todo-list li.priority-high { border-left: 5px solid var(--priority-high-color); padding-left: 10px;}
         .todo-list li.priority-medium { border-left: 5px solid var(--priority-medium-color); padding-left: 10px;}
         .todo-list li.priority-low { border-left: 5px solid var(--priority-low-color); padding-left: 10px;}
        /* ê¸°ë³¸ ë³´ë” ì™¼ìª½ë„ ë‘ê»˜ ë§ì¶”ê¸° */
         .todo-list li:not([class*="priority-"]) { border-left: 5px solid transparent; padding-left: 10px;}


         .todo-list li:hover {
             transform: translateY(-5px); /* í˜¸ë²„ ì‹œ ë” í¬ê²Œ ëœ¨ëŠ” íš¨ê³¼ */
             box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5); /* ê·¸ë¦¼ì ë” ì§„í•˜ê²Œ */
             border-color: var(--border-color); /* í˜¸ë²„ ì‹œ ë³´ë” ìœ ì§€ */
             border-left-color: inherit; /* ì™¼ìª½ ë³´ë” ìƒ‰ì€ ê·¸ëŒ€ë¡œ ìƒì† */
         }

         /* í•­ëª© ì¶”ê°€ ì‹œ ì• ë‹ˆë©”ì´ì…˜ */
         .todo-list li.adding {
              opacity: 0;
              transform: translateY(20px);
         }
          .todo-list li:not(.adding) {
               opacity: 1;
               transform: translateY(0);
          }

         /* í•­ëª© ì‚­ì œ ì‹œ ì• ë‹ˆë©”ì´ì…˜ (JSì—ì„œ í´ë˜ìŠ¤ ì¶”ê°€ í•„ìš”) */
         .todo-list li.removing {
             opacity: 0;
             transform: translateX(50px); /* ì˜†ìœ¼ë¡œ ì‚¬ë¼ì§€ëŠ” íš¨ê³¼ */
             margin-bottom: -50px; /* ì‚¬ë¼ì§€ë©´ì„œ ë‹¤ë¥¸ ìš”ì†Œë“¤ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì˜¬ë¼ì˜¤ë„ë¡ */
         }


        .todo-list li .todo-details {
             display: flex;
             flex-direction: column;
             flex-grow: 1;
             min-width: 150px;
             gap: 5px;
        }

         .todo-list li .todo-details .due-info {
             font-size: 0.85em;
             color: var(--light-text);
             font-weight: 500;
             display: flex;
             gap: 8px;
         }

        .todo-list li .todo-details .priority-category-info {
            font-size: 0.85em;
            font-weight: 500;
            display: flex;
            gap: 8px;
             flex-wrap: wrap;
        }
         .todo-list li .todo-details .priority-category-info .priority-label {
             color: var(--priority-medium-color);
         }
         .todo-list li.priority-important .todo-details .priority-category-info .priority-label {
             color: var(--priority-important-color);
             font-weight: 700;
         }
          .todo-list li.priority-high .todo-details .priority-category-info .priority-label { color: var(--priority-high-color); }
          .todo-list li.priority-medium .todo-details .priority-category-info .priority-label { color: var(--priority-medium-color); }
          .todo-list li.priority-low .todo-details .priority-category-info .priority-label { color: var(--priority-low-color); }


        .todo-list li .todo-details .category-label {
             color: var(--light-text);
             font-style: italic;
        }


        .todo-list li .todo-text {
            flex-grow: 1;
            font-size: 1em;
            color: var(--text-color);
            font-weight: 500;
             cursor: pointer;
             transition: color var(--animation-duration) ease, text-decoration var(--animation-duration) ease; /* ì™„ë£Œ ì• ë‹ˆë©”ì´ì…˜ */
        }

        /* ì™„ë£Œëœ í•  ì¼ ìŠ¤íƒ€ì¼ */
        .todo-list li.completed {
            background-color: #3a3a3a;
            border-color: #5a5a5a;
        }
        .todo-list li.completed .todo-details .due-info,
        .todo-list li.completed .todo-details .priority-category-info,
        .todo-list li.completed .todo-text {
            text-decoration: line-through;
            color: var(--completed-text);
            font-weight: 400;
        }
        /* ì™„ë£Œë˜ì–´ë„ ì™¼ìª½ ë³´ë” ìƒ‰ì€ ìœ ì§€ */
         .todo-list li.completed.priority-important { border-left-color: var(--priority-important-color); }
         .todo-list li.completed.priority-high { border-left-color: var(--priority-high-color); }
         .todo-list li.completed.priority-medium { border-left-color: var(--priority-medium-color); }
         .todo-list li.completed.priority-low { border-left-color: var(--priority-low-color); }


        .todo-list li .actions {
            display: flex;
            gap: 5px;
            flex-shrink: 0;
        }

        .todo-list li .actions button {
            background-color: transparent;
            color: var(--edit-color);
            border: none;
            padding: 6px 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.1s ease;
            font-size: 1.1em;
            line-height: 1;
        }
        .todo-list li .actions button:hover {
            color: var(--edit-hover);
             background-color: transparent;
        }
         .todo-list li .actions button:active {
             transform: scale(0.9);
         }
        .todo-list li .actions button.delete-btn {
            color: var(--delete-color);
        }
        .todo-list li .actions button.delete-btn:hover {
            color: var(--delete-hover);
        }

        .edit-area {
            display: flex;
            flex-grow: 1;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            min-width: 200px;
        }
        .edit-area .edit-input[type="text"],
        .edit-area .edit-input[type="date"],
        .edit-area .edit-input[type="time"],
        .edit-area .edit-select {
            flex-grow: 1;
            padding: 6px;
            border: 1px solid var(--input-border);
            border-radius: 4px;
            font-size: 1em;
            min-width: 60px;
            box-sizing: border-box;
            background-color: var(--input-bg);
            color: var(--text-color);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
         .edit-area .edit-input[type="text"]:focus,
         .edit-area .edit-input[type="date"]:focus,
         .edit-area .edit-input[type="time"]:focus,
         .edit-area .edit-select:focus {
             outline: none;
             border-color: var(--primary-color);
             box-shadow: 0 0 8px var(--focus-glow);
         }

         .edit-area .edit-input[type="time"] {
             width: 90px;
             flex-grow: 0;
             flex-shrink: 0;
         }
         .edit-area .edit-input[type="date"] {
             width: 120px;
             flex-grow: 0;
             flex-shrink: 0;
         }
         .edit-area .edit-select {
             width: 100px;
             flex-grow: 0;
             flex-shrink: 0;
             padding: 6px 4px;
         }
         .edit-area .edit-input[type="text"]:first-child {
             flex-grow: 2;
             min-width: 120px;
         }

    </style>
</head>
<body>
    <div class="container">
        <h1>MY TO-DO LIST</h1>

        <div class="input-area">
            <input type="text" id="todoInput" placeholder="ìƒˆë¡œìš´ í•  ì¼ ì¶”ê°€" onkeypress="handleKeyPress(event)">
            <input type="date" id="dateInput">
            <input type="time" id="timeInput">
            <select id="priorityInput">
                <option value="">ì¤‘ìš”ë„ ì„ íƒ</option>
                <option value="Low">ë‚®ìŒ</option>
                <option value="Medium">ë³´í†µ</option>
                <option value="High">ë†’ìŒ</option>
                <option value="Important">ğŸš¨ ì¤‘ìš”</option>
            </select>
            <input type="text" id="categoryInput" placeholder="#ì¹´í…Œê³ ë¦¬">
            <button onclick="addTodo()">ì¶”ê°€</button>
        </div>

        <div class="controls">
            <div class="counts">
                <span id="totalCount">ì´ í•  ì¼: 0</span>
                <span id="completedCount">ì™„ë£Œ: 0</span>
            </div>
            <div class="filter-sort-controls">
                 <select id="sortSelect" onchange="renderTodos()">
                     <option value="addedDesc">ìµœì‹ ìˆœ</option>
                     <option value="dateAsc">ë§ˆê°ì¼ ë¹ ë¥¸ìˆœ</option>
                     <option value="dateDesc">ë§ˆê°ì¼ ëŠ¦ì€ìˆœ</option> <!-- 'ë§ˆê°ì¼ ëŠ¦ì€ìˆœ' ì¶”ê°€ -->
                     <option value="priorityDesc">ì¤‘ìš”ë„ ë†’ì€ìˆœ</option>
                 </select>
                  <select id="filterSelect" onchange="renderTodos()">
                     <option value="all">ì „ì²´ ë³´ê¸°</option>
                     <option value="incomplete">ë¯¸ì™„ë£Œë§Œ ë³´ê¸°</option>
                     <option value="completed">ì™„ë£Œë§Œ ë³´ê¸°</option>
                 </select>
            </div>
            <button onclick="clearCompleted()">ì™„ë£Œëœ í•  ì¼ ì§€ìš°ê¸°</button>
        </div>


        <ul id="todoList" class="todo-list">
            <!-- í•  ì¼ í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë  ê±°ì˜ˆìš” -->
        </ul>
    </div>

    <script>
        let todos = [];

        document.addEventListener('DOMContentLoaded', () => {
            loadTodos();
            renderTodos(); // ë¡œë“œ í›„ ë°”ë¡œ í™”ë©´ì— ê·¸ë¦¬ê¸°
            updateCounts();
        });

        function addTodo() {
            const todoInput = document.getElementById('todoInput');
            const dateInput = document.getElementById('dateInput'); // ë‚ ì§œ ì…ë ¥ ê°€ì ¸ì˜¤ê¸°
            const timeInput = document.getElementById('timeInput');
            const priorityInput = document.getElementById('priorityInput'); // ì¤‘ìš”ë„ ì„ íƒ ê°€ì ¸ì˜¤ê¸°
            const categoryInput = document.getElementById('categoryInput'); // ì¹´í…Œê³ ë¦¬ ì…ë ¥ ê°€ì ¸ì˜¤ê¸°

            const todoText = todoInput.value.trim();
            const todoDate = dateInput.value;
            const todoTime = timeInput.value;
            const todoPriority = priorityInput.value || 'Low'; // ì„ íƒ ì•ˆ í•˜ë©´ ê¸°ë³¸ 'Low'
            const todoCategory = categoryInput.value.trim();


            if (todoText === "") {
                alert("í•  ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            const newTodo = {
                id: Date.now(), // ê³ ìœ  ID (í˜„ì¬ ì‹œê°„)
                text: todoText,
                date: todoDate, // ë‚ ì§œ ì •ë³´ ì¶”ê°€
                time: todoTime, // ì‹œê°„ ì •ë³´ ì¶”ê°€
                priority: todoPriority, // ì¤‘ìš”ë„ ì •ë³´ ì¶”ê°€
                category: todoCategory, // ì¹´í…Œê³ ë¦¬ ì •ë³´ ì¶”ê°€
                completed: false // ì™„ë£Œ ìƒíƒœ
            };

            todos.push(newTodo);

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            todoInput.value = "";
            dateInput.value = "";
            timeInput.value = "";
            priorityInput.value = ""; // ì¤‘ìš”ë„ ì´ˆê¸°í™”
            categoryInput.value = ""; // ì¹´í…Œê³ ë¦¬ ì´ˆê¸°í™”


            renderTodos(); // ëª©ë¡ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
            saveTodos(); // ì €ì¥
            updateCounts(); // ê°œìˆ˜ ì—…ë°ì´íŠ¸

             // ìƒˆë¡œ ì¶”ê°€ëœ í•­ëª©ì— ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì¶”ê°€ (ë Œë”ë§ í›„ ë°”ë¡œ)
            // ìš”ê±°ëŠ” renderTodos ì•ˆì—ì„œ ì²˜ë¦¬í•˜ëŠ” ê²Œ ë” ìì—°ìŠ¤ëŸ¬ìš¸ ìˆ˜ ìˆìŒ.
            // renderTodos í•¨ìˆ˜ ë‚´ì—ì„œ ìƒˆë¡œ ìƒì„±ëœ liì— 'adding' í´ë˜ìŠ¤ ì¶”ê°€ í›„ ì ì‹œ ë’¤ ì œê±° ë°©ì‹ ì‚¬ìš©
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                addTodo();
            }
        }

        // í•  ì¼ ëª©ë¡ í™”ë©´ì— ê·¸ë¦¬ê¸° (ì •ë ¬ ë° í•„í„°ë§, ì• ë‹ˆë©”ì´ì…˜ í¬í•¨)
        function renderTodos() {
            const todoList = document.getElementById('todoList');
            // ê¸°ì¡´ í•­ëª©ë“¤ì˜ ìƒíƒœ (ì™„ë£Œ, ìˆ˜ì • ì¤‘ ë“±)ë¥¼ ìœ ì§€í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì—
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ ëª©ë¡ì„ ë¹„ìš°ê³  ë‹¤ì‹œ ê·¸ë¦¬ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
            // ì• ë‹ˆë©”ì´ì…˜ì€ ì¶”ê°€ë  ë•Œì™€ ì™„ë£Œ ìƒíƒœ ë³€ê²½ ì‹œì—ë§Œ ì ìš©ë©ë‹ˆë‹¤.
            // ì‚­ì œ ì• ë‹ˆë©”ì´ì…˜ì€ removeTodo í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
             const existingItems = todoList.querySelectorAll('li'); // ê¸°ì¡´ í•­ëª©ë“¤ ê°€ì ¸ì˜¤ê¸°

            const sortValue = document.getElementById('sortSelect').value;
            const filterValue = document.getElementById('filterSelect').value;

            let filteredTodos = [...todos]; // ì›ë³¸ ë°°ì—´ ë³µì‚¬í•´ì„œ í•„í„°ë§/ì •ë ¬

            // í•„í„°ë§
            if (filterValue === 'incomplete') {
                filteredTodos = filteredTodos.filter(todo => !todo.completed);
            } else if (filterValue === 'completed') {
                filteredTodos = filteredTodos.filter(todo => todo.completed);
            }
             // ì¹´í…Œê³ ë¦¬ í•„í„° ë“±ì€ ì—¬ê¸°ì— ì¶”ê°€ ê°€ëŠ¥ (ì˜ˆ: filter(todo => todo.category === 'ê³µë¶€'))

            // ì •ë ¬
            filteredTodos.sort((a, b) => {
                if (sortValue === 'addedDesc') { // ìµœì‹ ìˆœ (ID ê¸°ì¤€)
                    return b.id - a.id;
                } else if (sortValue === 'dateAsc') { // ë§ˆê°ì¼ ë¹ ë¥¸ìˆœ (ì˜¤ë˜ëœ ìˆœì„œ)
                    const dateA = a.date || '9999-12-31';
                    const dateB = b.date || '9999-12-31';
                    const timeA = a.time || '23:59';
                    const timeB = b.time || '23:59';

                    if (dateA !== dateB) return dateA.localeCompare(dateB);
                    if (timeA !== timeB) return timeA.localeCompare(timeB);
                    return b.id - a.id;
                } else if (sortValue === 'dateDesc') { // ë§ˆê°ì¼ ëŠ¦ì€ìˆœ (ìƒˆë¡œìš´ ìˆœì„œ) - ì´ ë¶€ë¶„ì´ ìˆ˜ì •ë¨!
                    const dateA = a.date || '0000-01-01';
                    const dateB = b.date || '0000-01-01';
                    const timeA = a.time || '00:00';
                    const timeB = b.time || '00:00';

                     if (dateB !== dateA) return dateB.localeCompare(dateA);
                     if (timeB !== timeA) return timeB.localeCompare(timeA);
                    return b.id - a.id;
                }
                else if (sortValue === 'priorityDesc') { // ì¤‘ìš”ë„ ë†’ì€ìˆœ
                    const priorityOrder = { 'Important': 4, 'High': 3, 'Medium': 2, 'Low': 1, '': 0 };
                    const priorityA = priorityOrder[a.priority] || 0;
                    const priorityB = priorityOrder[b.priority] || 0;

                    if (priorityB !== priorityA) return priorityB - priorityA;
                    return b.id - a.id;
                }
                return b.id - a.id; // ê¸°ë³¸ ìµœì‹ ìˆœ
            });

            todoList.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ë¹„ìš°ê¸° (ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ ì‚­ì œ í•­ëª©ì€ ë³„ë„ ì²˜ë¦¬)


            filteredTodos.forEach(todo => {
                 const listItem = document.createElement('li');
                 listItem.dataset.id = todo.id;

                 // í•­ëª© ì¶”ê°€ ì‹œ ì• ë‹ˆë©”ì´ì…˜ ì ìš©
                 listItem.classList.add('adding'); // ì´ˆê¸°ì— adding í´ë˜ìŠ¤ ì¶”ê°€

                 // ì¤‘ìš”ë„ í´ë˜ìŠ¤ ë° ì™„ë£Œ ìƒíƒœ í´ë˜ìŠ¤ ì¶”ê°€
                 listItem.classList.add(`priority-${todo.priority ? todo.priority.toLowerCase() : 'none'}`);
                 if (todo.completed) {
                     listItem.classList.add('completed');
                 }

                 const todoDetailsDiv = document.createElement('div');
                 todoDetailsDiv.classList.add('todo-details');

                  const dueInfoDiv = document.createElement('div');
                  dueInfoDiv.classList.add('due-info');
                   if(todo.date) {
                      const dateSpan = document.createElement('span');
                      dateSpan.classList.add('due-date');
                      dateSpan.textContent = todo.date.replace(/-/g, '.');
                      dueInfoDiv.appendChild(dateSpan);
                   }
                  if(todo.time) {
                     const timeSpan = document.createElement('span');
                     timeSpan.classList.add('due-time');
                     timeSpan.textContent = todo.time;
                     dueInfoDiv.appendChild(timeSpan);
                  }
                 if (dueInfoDiv.hasChildNodes()) {
                      todoDetailsDiv.appendChild(dueInfoDiv);
                 }


                  const metaInfoDiv = document.createElement('div');
                  metaInfoDiv.classList.add('priority-category-info');
                   if(todo.priority) {
                      const prioritySpan = document.createElement('span');
                      prioritySpan.classList.add('priority-label');
                      let priorityText = todo.priority;
                      if (todo.priority === 'Important') priorityText = 'ğŸš¨ ì¤‘ìš”';
                      else if (todo.priority === 'High') priorityText = 'ğŸ”º ë†’ìŒ';
                      else if (todo.priority === 'Medium') priorityText = 'ğŸ”¹ ë³´í†µ';
                      else if (todo.priority === 'Low') priorityText = 'ğŸ”» ë‚®ìŒ';
                      prioritySpan.textContent = priorityText;
                      metaInfoDiv.appendChild(prioritySpan);
                   }
                   if(todo.category) {
                      const categorySpan = document.createElement('span');
                      categorySpan.classList.add('category-label');
                      categorySpan.textContent = `#${todo.category}`;
                      metaInfoDiv.appendChild(categorySpan);
                   }
                  if (metaInfoDiv.hasChildNodes()) {
                      todoDetailsDiv.appendChild(metaInfoDiv);
                  }


                 const todoTextSpan = document.createElement('span');
                 todoTextSpan.classList.add('todo-text');
                 todoTextSpan.textContent = todo.text;
                 todoTextSpan.onclick = () => toggleComplete(todo.id);
                 todoDetailsDiv.appendChild(todoTextSpan);


                 const actionsDiv = document.createElement('div');
                 actionsDiv.classList.add('actions');

                 // ì•„ì´ì½˜ ë²„íŠ¼ìœ¼ë¡œ ë³€ê²½
                 const editButton = document.createElement('button');
                 editButton.classList.add('edit-btn'); // ìˆ˜ì • ë²„íŠ¼ í´ë˜ìŠ¤ ì¶”ê°€
                 editButton.innerHTML = '<i class="fas fa-edit"></i>'; // ìˆ˜ì • ì•„ì´ì½˜
                 editButton.onclick = () => editTodo(todo.id);

                 const deleteButton = document.createElement('button');
                 deleteButton.classList.add('delete-btn');
                 deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>'; // ì‚­ì œ ì•„ì´ì½˜
                 deleteButton.onclick = () => removeTodo(todo.id);

                 actionsDiv.appendChild(editButton);
                 actionsDiv.appendChild(deleteButton);

                 listItem.appendChild(todoDetailsDiv);
                 listItem.appendChild(actionsDiv);


                 todoList.appendChild(listItem);

                 // DOMì— ì¶”ê°€ëœ í›„ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì œê±°í•˜ì—¬ íŠ¸ëœì§€ì…˜ ë°œìƒ
                 requestAnimationFrame(() => {
                    listItem.classList.remove('adding');
                 });
            });
        }

        function removeTodo(id) {
            const listItem = document.querySelector(`li[data-id='${id}']`);
            if (listItem) {
                // ì‚­ì œ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì¶”ê°€
                listItem.classList.add('removing');

                // ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ í›„ ì‹¤ì œ DOM ìš”ì†Œ ì‚­ì œ ë° ë°ì´í„° ì—…ë°ì´íŠ¸
                listItem.addEventListener('transitionend', () => {
                    // transitionend ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ê²Œ ì²˜ë¦¬
                    if (listItem.parentElement) { // ë¶€ëª¨ ìš”ì†Œê°€ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸
                         listItem.remove(); // DOMì—ì„œ ìš”ì†Œ ì‚­ì œ
                         todos = todos.filter(todo => todo.id !== id); // ë°°ì—´ì—ì„œë„ ì‚­ì œ
                         saveTodos();
                         updateCounts();
                         // renderTodos(); // ì‚­ì œ í›„ì—ëŠ” ì „ì²´ë¥¼ ë‹¤ì‹œ ê·¸ë¦´ í•„ìš” ì—†ìŒ (CSSë¡œ ì²˜ë¦¬ë˜ë¯€ë¡œ)
                    }
                }, { once: true }); // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ë„ë¡ ì˜µì…˜ ì¶”ê°€

                // ë§Œì•½ transitionend ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì§€ ì•Šì„ ê²½ìš°ë¥¼ ëŒ€ë¹„ (fallback)
                 // ì§§ì€ ì• ë‹ˆë©”ì´ì…˜ì˜ ê²½ìš° ì´ë²¤íŠ¸ê°€ ëˆ„ë½ë  ìˆ˜ ìˆìŒ.
                 // ì—¬ê¸°ì„œëŠ” CSS transition durationê³¼ ë§ì¶”ëŠ” ê²ƒì´ ì¢‹ìŒ.
                 const duration = parseFloat(getComputedStyle(listItem).transitionDuration) * 1000;
                 setTimeout(() => {
                    // transitionendê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ì—¬ê¸°ì„œ ì‚­ì œ
                    if (listItem.parentElement) {
                        listItem.remove();
                        todos = todos.filter(todo => todo.id !== id);
                        saveTodos();
                        updateCounts();
                    }
                 }, duration + 50); // ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„ë³´ë‹¤ ì•½ê°„ ë” ê¸¸ê²Œ ì„¤ì •

            } else {
                 // listItemì´ ì—†ëŠ” ê²½ìš° (ì´ë¯¸ ì‚­ì œë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜)
                 todos = todos.filter(todo => todo.id !== id);
                 saveTodos();
                 updateCounts();
                 renderTodos(); // í˜¹ì‹œ ëª¨ë¥´ë‹ˆ ëª©ë¡ ì „ì²´ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
            }
        }

        function toggleComplete(id) {
            const todo = todos.find(todo => todo.id === id);
            if (todo) {
                todo.completed = !todo.completed;
                // renderTodos(); // ì „ì²´ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ì§€ ì•Šê³  í•´ë‹¹ í•­ëª©ë§Œ í´ë˜ìŠ¤ í† ê¸€
                const listItem = document.querySelector(`li[data-id='${id}']`);
                if (listItem) {
                     listItem.classList.toggle('completed', todo.completed); // completed í´ë˜ìŠ¤ í† ê¸€
                }
                saveTodos();
                updateCounts();
            }
        }

        // í•  ì¼ ìˆ˜ì • í•¨ìˆ˜
        function editTodo(id) {
            const listItem = document.querySelector(`li[data-id='${id}']`);
            const todoDetailsDiv = listItem.querySelector('.todo-details');
            const actionsDiv = listItem.querySelector('.actions');

            // ì´ë¯¸ ìˆ˜ì • ì¤‘ì¸ì§€ í™•ì¸
            if (listItem.querySelector('.edit-area')) {
                return;
            }

            const todo = todos.find(todo => todo.id === id);
            if (!todo) return;

            // ê¸°ì¡´ ë²„íŠ¼ ìˆ¨ê¸°ê¸° (CSSë¡œ ì²˜ë¦¬í•´ë„ ë¨)
            actionsDiv.style.display = 'none';

            const editArea = document.createElement('div');
            editArea.classList.add('edit-area');

            const editTextInput = document.createElement('input');
            editTextInput.type = 'text';
            editTextInput.className = 'edit-input';
            editTextInput.value = todo.text;
            editTextInput.placeholder = "í•  ì¼ ë‚´ìš©";

            const editDateInput = document.createElement('input');
            editDateInput.type = 'date';
            editDateInput.className = 'edit-input';
            editDateInput.value = todo.date;

            const editTimeInput = document.createElement('input');
            editTimeInput.type = 'time';
            editTimeInput.className = 'edit-input';
            editTimeInput.value = todo.time;

            const editPrioritySelect = document.createElement('select');
             editPrioritySelect.className = 'edit-select';
             const priorities = [{value: '', text: 'ì¤‘ìš”ë„ ì„ íƒ'}, {value: 'Low', text: 'ë‚®ìŒ'}, {value: 'Medium', text: 'ë³´í†µ'}, {value: 'High', text: 'ë†’ìŒ'}, {value: 'Important', text: 'ğŸš¨ ì¤‘ìš”'}];
             priorities.forEach(p => {
                 const option = document.createElement('option');
                 option.value = p.value;
                 option.textContent = p.text;
                 if (todo.priority === p.value) {
                     option.selected = true;
                 }
                 editPrioritySelect.appendChild(option);
             });

            const editCategoryInput = document.createElement('input');
            editCategoryInput.type = 'text';
            editCategoryInput.className = 'edit-input';
            editCategoryInput.value = todo.category;
            editCategoryInput.placeholder = "#ì¹´í…Œê³ ë¦¬";


            editArea.appendChild(editTextInput);
            editArea.appendChild(editDateInput);
            editArea.appendChild(editTimeInput);
            editArea.appendChild(editPrioritySelect);
            editArea.appendChild(editCategoryInput);

            // ì €ì¥ ë° ì·¨ì†Œ ë²„íŠ¼ ì¶”ê°€ (ìˆ˜ì • ëª¨ë“œì—ì„œë§Œ ë³´ì„)
             const saveButton = document.createElement('button');
             saveButton.textContent = 'ì €ì¥';
             // ì•„ì´ì½˜ìœ¼ë¡œ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´
             // saveButton.innerHTML = '<i class="fas fa-save"></i>';
             saveButton.classList.add('save-edit-btn'); // ì €ì¥ ë²„íŠ¼ í´ë˜ìŠ¤ ì¶”ê°€
             // ìŠ¤íƒ€ì¼ì€ CSSë¡œ ê´€ë¦¬í•˜ëŠ” ê²Œ ì¢‹ì§€ë§Œ, ì„ì‹œë¡œ ì—¬ê¸°ì„œ ì§€ì • ê°€ëŠ¥
             // saveButton.style.backgroundColor = 'var(--secondary-color)'; // ì˜ˆì‹œ ìƒ‰ìƒ
             // saveButton.style.color = '#121212'; // ì˜ˆì‹œ ìƒ‰ìƒ
             saveButton.onclick = () => saveEditedTodo(id, editTextInput.value, editDateInput.value, editTimeInput.value, editPrioritySelect.value, editCategoryInput.value);


             const cancelButton = document.createElement('button');
             cancelButton.textContent = 'ì·¨ì†Œ';
             // ì•„ì´ì½˜ìœ¼ë¡œ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´
             // cancelButton.innerHTML = '<i class="fas fa-times"></i>';
             cancelButton.classList.add('cancel-edit-btn'); // ì·¨ì†Œ ë²„íŠ¼ í´ë˜ìŠ¤ ì¶”ê°€
              // ìŠ¤íƒ€ì¼ì€ CSSë¡œ ê´€ë¦¬í•˜ëŠ” ê²Œ ì¢‹ì§€ë§Œ, ì„ì‹œë¡œ ì—¬ê¸°ì„œ ì§€ì • ê°€ëŠ¥
             // cancelButton.style.backgroundColor = '#6c757d'; // ì˜ˆì‹œ ìƒ‰ìƒ
             // cancelButton.style.color = 'white'; // ì˜ˆì‹œ ìƒ‰ìƒ

             cancelButton.onclick = () => {
                 renderTodos(); // ëª©ë¡ ë‹¤ì‹œ ê·¸ë ¤ì„œ ìˆ˜ì • ëª¨ë“œ í•´ì œ ë° ì›ë˜ ë²„íŠ¼ ë³´ì´ê²Œ
                 // actionsDiv.style.display = 'flex'; // renderTodosê°€ ì•Œì•„ì„œ ì²˜ë¦¬í•¨
             };

            const editActionsDiv = document.createElement('div');
            editActionsDiv.classList.add('actions'); // ê°™ì€ actions ìŠ¤íƒ€ì¼ ì‚¬ìš©
             editActionsDiv.appendChild(saveButton);
             editActionsDiv.appendChild(cancelButton);

            todoDetailsDiv.style.display = 'none';
            listItem.insertBefore(editArea, actionsDiv); // actions ì•ì— ìˆ˜ì • ì˜ì—­ ì‚½ì…
            listItem.insertBefore(editActionsDiv, actionsDiv); // actions ì•ì— ì €ì¥/ì·¨ì†Œ ë²„íŠ¼ ì˜ì—­ ì‚½ì…
             actionsDiv.style.display = 'none'; // ì›ë˜ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ ì˜ì—­ ìˆ¨ê¹€


            editTextInput.focus();

            const inputsInEditArea = editArea.querySelectorAll('input, select');
             inputsInEditArea.forEach(input => {
                 input.onkeypress = (event) => {
                    if (event.key === 'Enter') {
                        // ëª¨ë“  ì…ë ¥ì°½ì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì™€ì„œ ì €ì¥ í•¨ìˆ˜ í˜¸ì¶œ
                        saveEditedTodo(
                            id,
                            editTextInput.value,
                            editDateInput.value,
                            editTimeInput.value,
                            editPrioritySelect.value,
                            editCategoryInput.value
                         );
                    }
                 };
             });
        }

        function saveEditedTodo(id, newText, newDate, newTime, newPriority, newCategory) {
             const newTrimmedText = newText.trim();

            if (newTrimmedText === "") {
                alert("í•  ì¼ ë‚´ìš©ì„ ë¹„ì›Œë‘˜ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!");
                renderTodos(); // ì…ë ¥ ì·¨ì†Œ ì‹œ ëª©ë¡ ë‹¤ì‹œ ê·¸ë ¤ì„œ ìˆ˜ì • ëª¨ë“œ í•´ì œ
                return;
            }

            const todo = todos.find(todo => todo.id === id);
            if (todo) {
                todo.text = newTrimmedText;
                todo.date = newDate;
                todo.time = newTime;
                todo.priority = newPriority || 'Low';
                todo.category = newCategory.trim();


                renderTodos(); // ëª©ë¡ ë‹¤ì‹œ ê·¸ë¦¬ê¸° (ìˆ˜ì • ëª¨ë“œ í•´ì œ í¬í•¨)
                saveTodos();
                 updateCounts();
            }
        }

        function clearCompleted() {
            if(confirm("ì™„ë£Œëœ í•  ì¼ì„ ëª¨ë‘ ì§€ìš¸ê¹Œìš”?")) {
                 // ì‚­ì œ ì• ë‹ˆë©”ì´ì…˜ì„ ì ìš©í•˜ë ¤ë©´ filter ëŒ€ì‹  í•˜ë‚˜ì”© removeTodo í˜¸ì¶œ í•„ìš”
                 // í•˜ì§€ë§Œ ì™„ë£Œëœ í•­ëª©ì´ ë§ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ë°”ë¡œ ë°ì´í„° ì‚­ì œ í›„ ë Œë”ë§
                 const completedTodos = todos.filter(todo => todo.completed);
                 if (completedTodos.length > 0) {
                      todos = todos.filter(todo => !todo.completed);
                      saveTodos();
                      updateCounts();
                      renderTodos(); // ì „ì²´ ëª©ë¡ ë‹¤ì‹œ ê·¸ë ¤ì„œ ì™„ë£Œ í•­ëª© ì œê±°
                 } else {
                     alert("ì™„ë£Œëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.");
                 }
            }
        }

        function updateCounts() {
            const totalCountSpan = document.getElementById('totalCount');
            const completedCountSpan = document.getElementById('completedCount');

            const total = todos.length;
            const completed = todos.filter(todo => todo.completed).length;

            totalCountSpan.textContent = `ì´ í•  ì¼: ${total}`;
            completedCountSpan.textContent = `ì™„ë£Œ: ${completed}`;
        }

        function saveTodos() {
            localStorage.setItem('myTodos', JSON.stringify(todos));
        }

        function loadTodos() {
            const savedTodos = localStorage.getItem('myTodos');
            if (savedTodos) {
                todos = JSON.parse(savedTodos);
                todos = todos.map(todo => ({
                    ...todo,
                    date: todo.date || '',
                    time: todo.time || '',
                    priority: todo.priority || 'Low',
                    category: todo.category || '',
                    // completed: todo.completed || false // completed í•„ë“œ ì—†ì„ ê²½ìš° ëŒ€ë¹„ (ì´ì „ ì½”ë“œì—ì„œ ì¶”ê°€ë¨)
                }));
            } else {
                todos = [];
            }
        }

    </script>
</body>
</html>
